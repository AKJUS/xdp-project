# -*- fill-column: 79; -*-
#+TITLE: Discussing /page_pool/ development directions
#+AUTHOR: Jesper Dangaard Brouer <hawk@kernel.org>
#+EMAIL: hawk@kernel.org
#+REVEAL_THEME: redhat
#+REVEAL_TRANS: linear
#+REVEAL_MARGIN: 0
#+REVEAL_EXTRA_JS: { src: '../reveal.js/js/redhat.js'}
#+REVEAL_ROOT: ../reveal.js
#+OPTIONS: reveal_center:nil reveal_control:t reveal_history:nil
#+OPTIONS: reveal_width:1600 reveal_height:900
#+OPTIONS: ^:nil tags:nil toc:nil num:nil ':t

* For conference: NetConf 2023                                     :noexport:

This presentation will be given at [[http://vger.kernel.org/netconf2023.html][Netconf 2023]].

* Brainstorm                                                       :noexport:

Page Pool started out as: memory optimization for XDP
 - PP alloc cache for XDP_DROP use-case
 - And recycle XDP redirected frames (see =xdp_return_frame=)
 - PP pages could not be recycled via netstack (/possible today/)
 - Optimized for 1-page per packet (keeping page refcnt==1)

Summarise: how PP evolved

Today Page Pool have full netstack recycling support
 - (See =skb_mark_for_recycle()=)
 - Recently removed API for non-recycle option
   - 535b9c61bdef ("net: page_pool: hide page_pool_release_page()")


Change to struct page have pointer back to page_pool object
 - c07aea3ef4d4 ("mm: add a signature in struct page")


Include files restructured
 - (find commit)



Page Pool evolving into netstack memory layer

Future development

Memory providers (by Jakub)
 - Making it possible replace "backend" e.g. page-allocator
 - e.g. allocate huge-page and split-up
   - to reduce IOTLB misses when using DMA IOMMU

Fragmenting pages
 - Cutting page into smaller pieces
 - via page->frag_count

Extending PP with API to hide frag_count handling
 - [PATCH net-next v8 0/6] introduce page_pool_alloc() related API
 - Yunsheng Lin <linyunsheng@huawei.com>


* Page Pool evolving into *netstack memory layer*?                   :export:

* Slide: Thanks                                                      :export:

*/Thanks/* to recent Page Pool contributors
 - *Huawei*: /Yunsheng Lin/ + /Jie Wang/
 - *Meta*: /Jakub Kicinski/ + /Alexander Duyck/
 - *Intel*: /Alexander Lobakin/
 - *Red Hat*: /Lorenzo Bianconi/
 - *Fastly*: /Joe Damato/
 - *Linaro*: /Ilias Apalodimas/

* Emacs tricks                                                     :noexport:

# Local Variables:
# org-re-reveal-title-slide: "<h1 class=\"title\">%t</h1>
# <h2 class=\"author\">
# Jesper Dangaard Brouer<br/></h2>
# <h3>Netconf<br/>Paris, Sep 2023</h3>"
# org-export-filter-headline-functions: ((lambda (contents backend info) (replace-regexp-in-string "Slide: " "" contents)))
# End:
