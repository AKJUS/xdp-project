# -*- fill-column: 79; -*-
#+TITLE: XDP hints via BPF Type Format (BTF) system
#+AUTHOR: Jesper Dangaard Brouer <hawk@kernel.org>
#+EMAIL: brouer@redhat.com
#+REVEAL_THEME: redhat
#+REVEAL_TRANS: linear
#+REVEAL_MARGIN: 0
#+REVEAL_EXTRA_JS: { src: '../reveal.js/js/redhat.js'}
#+REVEAL_ROOT: ../reveal.js
#+OPTIONS: reveal_center:nil reveal_control:t reveal_history:nil
#+OPTIONS: reveal_width:1600 reveal_height:900
#+OPTIONS: ^:nil tags:nil toc:nil num:nil ':t

* For conference: Linux Plumbers Conference 2022

[[https://lpc.events/event/16/contributions/1362/][This presentation]] will be given at
[[https://lpc.events/event/16/][LPC 2022]] the Linux Plumbers Conference (LPC).

* Slides below                                                     :noexport:

Only sections with tag ":export:" will end-up in the presentation.

Colors are choosen via org-mode italic/bold high-lighting:
 - /italic/ = /green/
 - *bold*   = *yellow*
 - */italic-bold/* = red

* Slide: What are XDP-hints                                          :export:

/XDP-hints/ dates back to NetDevConf [[https://www.youtube.com/watch?v=uD1_oAHpUmU][Nov 2017]] (by [[https://legacy.netdevconf.info/2.2/papers/waskiewicz-xdpacceleration-talk.pdf][PJ Waskiewicz]])
 - Purpose: /Let XDP access HW offload hints/

Basic idea:
 - Provide or extract (from descriptor) NIC hardware offload hints
 - *Store info in XDP metadata area* (located before pkt header)

XDP /metadata area/ avail since [[https://www.spinics.net/lists/netdev/msg456525.html][Sep 2017]] (by Daniel Borkmann)
 - *Space is limited* (currently 32 bytes)

Main reason XDP-hints work *stalled*
 - */No consensus/* on *layout* of XDP metadata
 - /BTF/ was *not ready* at that time

* Slide: What are *traditional* hardware offload hints?              :export:

NIC *hardware* provides offload hints in RX (and TX) *descriptors*
 - */The netstack SKB/* packet data-struct stores+uses these

*RX descriptors* can e.g. provide:
 - RX-/checksum/ validation, RX-/hash/ value, RX-/timestamp/
 - RX-/VLAN/ provides VLAN ID/tag non-inline

*TX descriptors* can e.g. ask hardware to perform actions:
 - *TX*-/checksum/: Ask hardware to compute checksums on transmission
 - TX-/VLAN/: Ask hardware to insert VLAN tag
 - Advanced: /TX-timestamp/ HW stores TX-time and feeds back on completion
 - Advanced: /TX-LaunchTime/ ask HW to send packet at specific time in future

* Slide: End: /Questions?/                                         :export:
:PROPERTIES:
:reveal_extra_attr: class="mid-slide"
:END:

* Emacs end-tricks                                                 :noexport:

This section contains some emacs tricks, that e.g. remove the "Slide:" prefix
in the compiled version.

# Local Variables:
# org-re-reveal-title-slide: "<h1 class=\"title\">%t</h1>
# <h2 class=\"author\">Jesper Dangaard Brouer<br/>
# <span style=\"font-size:75%%\">Sr. Principal Kernel Engineer, Red Hat</span></h2>
# <h3>Linux Plumbers Conference</br>September 2022</h3>"
# org-export-filter-headline-functions: ((lambda (contents backend info) (replace-regexp-in-string "Slide: ?" "" contents)))
# End:
